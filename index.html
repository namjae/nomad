<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Nomad by sashaafm</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Nomad</h1>
          <h2>Elixir/Phoenix Cloud SDK and Deployment Tool</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/sashaafm/nomad/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/sashaafm/nomad/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/sashaafm/nomad" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="nomad-tutorials" class="anchor" href="#nomad-tutorials" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Nomad Tutorials</h1>

<p><strong>Table of Contents</strong></p>

<ul>
<li><a href="#installation">Installation and Configuration</a></li>
<li><a href="#storage_tutorial">Storage Tutorial</a></li>
</ul>

<h2>
<a id="installation-and-configuration" class="anchor" href="#installation-and-configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation and Configuration<a name="installation"></a>
</h2>

<p>To use Nomad first do the following steps:</p>

<ol>
<li>
<p>Add nomad to your list of dependencies in mix.exs:</p>

<pre><code>  def deps do
      [{:nomad, "~&gt; 0.5.1"}]
  end
or
  def deps do 
      [{:nomad, github: "sashaafm/nomad" }]
    end
</code></pre>
</li>
<li>
<p>Ensure nomad is started before your application:</p>

<pre><code>  def application do
    [applications: [:nomad]]
  end
</code></pre>
</li>
<li>
<p>For every cloud provider you will need to add to your desired environment the following:</p>

<pre><code> config :nomad, 
   cloud_provider: &lt;provider_atom&gt;
</code></pre>
</li>
<li>
<p>Each provider needs different configurations</p>

<p>To use <strong>Amazon Web Services</strong> the following configurations are needed:</p>

<pre><code> config :nomad,
   cloud_provider: :aws
</code></pre>

<p>Then pass your AWS Access Key ID and AWS Secret Access Key as System variables when launching the application like so:</p>

<pre><code> AWS_ACCESS_KEY_ID=&lt;aws_access_key_id&gt; AWS_SECRET_ACCESS_KEY=&lt;secret_access_key&gt;
</code></pre>

<p>To use <strong>Google Cloud Platform</strong> the following configurations are needed:</p>

<pre><code> config :nomad,
   cloud_provider: :gcl

 config :goth, 
   json: "config/creds.json" |&gt; Path.expand |&gt; File.read!
</code></pre>

<p>Where 'creds.json' is the JSON file with your account credentials that you may download from your Google Cloud Console. Alternatively you may name the file whatever you want as long as you change the config accordingly.</p>
</li>
</ol>

<p>The atom passed in the <strong>:cloud_provider</strong> key will tell Nomad what API function blocks will need to be generated.</p>

<h2>
<a id="storage-tutorial" class="anchor" href="#storage-tutorial" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Storage Tutorial<a name="storage_tutorial"></a>
</h2>

<p>Nomad provides an API for interaction with cloud storage services like Amazon S3 or Google Cloud Storage. For this tutorial let's create a storage bucket, upload a file, delete it and then delete the bucket. We'll be using Google Cloud Storage so be sure to input the necessary configs first. Fire up Nomad in IEx with <code>iex -s mix</code>:</p>

<p>First let's create the storage bucket. This function takes 3 arguments - the name, the region and the storage class.</p>

<pre><code>iex&gt; Nomad.Storage.create_storage "storage_nomad_tutorial", "europe-west1", "STANDARD"
:ok
</code></pre>

<p>All right! Let's check if it indeed was created.</p>

<pre><code>iex&gt; Nomad.Storage.list_storages
["storage_nomad_1", "storage_nomad_2", "storage_nomad_tutorial"]
</code></pre>

<p>Everything seems correct. Now let's upload a file to our new storage. The <code>Nomad.Storage.put_item</code> also takes 3 arguments - the desired storage name, the filepath of the file we want to upload and the storage path (the directory in the storage where we want to store the file).</p>

<pre><code>iex&gt; Nomad.Storage.put_item "storage_nomad_tutorial", "README.md", "random/tutorial/README.md"
:ok
</code></pre>

<p>Success! Let's confirm it was indeed uploaded with the <code>Nomad.Storage.list_items</code> function.</p>

<pre><code>iex&gt; Nomad.Storage.list_items "storage_nomad_tutorial"     
["random/tutorial/README.md"]
</code></pre>

<p>There it is. Nomad also creates the directory structure if it doesn't exist. Let's delete it.</p>

<pre><code>iex&gt; Nomad.Storage.delete_item "storage_nomad_tutorial", "random/tutorial/README.md"
:ok
iex&gt; Nomad.Storage.list_items "storage_nomad_tutorial"
[]
</code></pre>

<p>The file was deleted! Now to finish we'll delete the storage.</p>

<pre><code>iex&gt; Nomad.Storage.delete_storage "storage_nomad_tutorial"
:ok
iex&gt; Nomad.Storage.list_storages
["storage_nomad_1", "storage_nomad_2"]
</code></pre>

<p>And there it is! Remember that you could have used any other supported cloud provider in the exact same way as long as you change the configurations to the appropriate ones! <strong>No code changes required!</strong></p>
        </section>

        <footer>
          Nomad is maintained by <a href="https://github.com/sashaafm">sashaafm</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
